{
    "sourceFile": "Resources/Orthanc/DownloadOrthancFramework.cmake",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 7,
            "patches": [
                {
                    "date": 1628033395094,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1628033405811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.3.2\")\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n-      elseif\n+      elseif (ORTHANC_)\n       endif()\n     endif()\n   endif()\n endif()\n"
                },
                {
                    "date": 1628033415190,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.3.2\")\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n-      elseif (ORTHANC_)\n+      elseif (ORTHANC_FRAMEWORK_VERSION STREQ)\n       endif()\n     endif()\n   endif()\n endif()\n"
                },
                {
                    "date": 1628033422056,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.3.2\")\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n-      elseif (ORTHANC_FRAMEWORK_VERSION STREQ)\n+      elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.9.6\")\n       endif()\n     endif()\n   endif()\n endif()\n"
                },
                {
                    "date": 1628033434728,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,8 +87,9 @@\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.9.6\")\n+        set(ORTHANC_FRAMEWORK_MD5 )\n       endif()\n     endif()\n   endif()\n endif()\n"
                },
                {
                    "date": 1628033671131,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.9.6\")\n-        set(ORTHANC_FRAMEWORK_MD5 )\n+        set(ORTHANC_FRAMEWORK_MD5 \"d41d8cd98f00b204e9800998ecf8427e\")\n       endif()\n     endif()\n   endif()\n endif()\n@@ -223,9 +223,9 @@\n   else()\n     # Default case: Download from the official Web site\n     set(ORTHANC_FRAMEMORK_FILENAME Orthanc-${ORTHANC_FRAMEWORK_VERSION}.tar.gz)\n     #set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/get.php?path=/orthanc/${ORTHANC_FRAMEMORK_FILENAME}\")\n-    set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/third-party/orthanc-framework/${ORTHANC_FRAMEMORK_FILENAME}\")\n+    # set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/third-party/orthanc-framework/${ORTHANC_FRAMEMORK_FILENAME}\")\n   endif()\n \n   set(ORTHANC_FRAMEWORK_ARCHIVE \"${CMAKE_SOURCE_DIR}/ThirdPartyDownloads/${ORTHANC_FRAMEMORK_FILENAME}\")\n \n"
                },
                {
                    "date": 1628033683970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -222,9 +222,9 @@\n     string(REGEX REPLACE \"^.*/\" \"\" ORTHANC_FRAMEMORK_FILENAME \"${ORTHANC_FRAMEWORK_URL}\")\n   else()\n     # Default case: Download from the official Web site\n     set(ORTHANC_FRAMEMORK_FILENAME Orthanc-${ORTHANC_FRAMEWORK_VERSION}.tar.gz)\n-    #set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/get.php?path=/orthanc/${ORTHANC_FRAMEMORK_FILENAME}\")\n+    set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/get.php?path=/orthanc/${ORTHANC_FRAMEMORK_FILENAME}\")\n     # set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/third-party/orthanc-framework/${ORTHANC_FRAMEMORK_FILENAME}\")\n   endif()\n \n   set(ORTHANC_FRAMEWORK_ARCHIVE \"${CMAKE_SOURCE_DIR}/ThirdPartyDownloads/${ORTHANC_FRAMEMORK_FILENAME}\")\n"
                },
                {
                    "date": 1628033717523,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n         set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n         set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n       elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.9.6\")\n-        set(ORTHANC_FRAMEWORK_MD5 \"d41d8cd98f00b204e9800998ecf8427e\")\n+        set(ORTHANC_FRAMEWORK_MD5 \"4b5d05683d747c29b2860ad79d11e62e\")\n       endif()\n     endif()\n   endif()\n endif()\n"
                }
            ],
            "date": 1628033395094,
            "name": "Commit-0",
            "content": "# Orthanc - A Lightweight, RESTful DICOM Store\n# Copyright (C) 2012-2016 Sebastien Jodogne, Medical Physics\n# Department, University Hospital of Liege, Belgium\n# Copyright (C) 2017-2018 Osimis S.A., Belgium\n#\n# This program is free software: you can redistribute it and/or\n# modify it under the terms of the GNU General Public License as\n# published by the Free Software Foundation, either version 3 of the\n# License, or (at your option) any later version.\n#\n# In addition, as a special exception, the copyright holders of this\n# program give permission to link the code of its release with the\n# OpenSSL project's \"OpenSSL\" library (or with modified versions of it\n# that use the same license as the \"OpenSSL\" library), and distribute\n# the linked executables. You must obey the GNU General Public License\n# in all respects for all of the code used other than \"OpenSSL\". If you\n# modify file(s) with this exception, you may extend this exception to\n# your version of the file(s), but you are not obligated to do so. If\n# you do not wish to do so, delete this exception statement from your\n# version. If you delete this exception statement from all source files\n# in the program, then also delete it here.\n#\n# This program is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n# General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program. If not, see <http://www.gnu.org/licenses/>.\n\n\n\n##\n## Check whether the parent script sets the mandatory variables\n##\n\nif (NOT DEFINED ORTHANC_FRAMEWORK_SOURCE OR\n    (NOT ORTHANC_FRAMEWORK_SOURCE STREQUAL \"hg\" AND\n     NOT ORTHANC_FRAMEWORK_SOURCE STREQUAL \"web\" AND\n     NOT ORTHANC_FRAMEWORK_SOURCE STREQUAL \"archive\" AND\n     NOT ORTHANC_FRAMEWORK_SOURCE STREQUAL \"path\"))\n  message(FATAL_ERROR \"The variable ORTHANC_FRAMEWORK_SOURCE must be set to \\\"hg\\\", \\\"web\\\", \\\"archive\\\" or \\\"path\\\"\")\nendif()\n\n\n##\n## Detection of the requested version\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"hg\" OR\n    ORTHANC_FRAMEWORK_SOURCE STREQUAL \"archive\" OR\n    ORTHANC_FRAMEWORK_SOURCE STREQUAL \"web\")\n  if (NOT DEFINED ORTHANC_FRAMEWORK_VERSION)\n    message(FATAL_ERROR \"The variable ORTHANC_FRAMEWORK_VERSION must be set\")\n  endif()\n\n  if (DEFINED ORTHANC_FRAMEWORK_MAJOR OR\n      DEFINED ORTHANC_FRAMEWORK_MINOR OR\n      DEFINED ORTHANC_FRAMEWORK_REVISION OR\n      DEFINED ORTHANC_FRAMEWORK_MD5)\n    message(FATAL_ERROR \"Some internal variable has been set\")\n  endif()\n\n  set(ORTHANC_FRAMEWORK_MD5 \"\")\n\n  if (NOT DEFINED ORTHANC_FRAMEWORK_BRANCH)\n    if (ORTHANC_FRAMEWORK_VERSION STREQUAL \"mainline\")\n      set(ORTHANC_FRAMEWORK_BRANCH \"default\")\n\n    else()\n      set(ORTHANC_FRAMEWORK_BRANCH \"Orthanc-${ORTHANC_FRAMEWORK_VERSION}\")\n\n      set(RE \"^([0-9]+)\\\\.([0-9]+)\\\\.([0-9]+)$\")\n      string(REGEX REPLACE ${RE} \"\\\\1\" ORTHANC_FRAMEWORK_MAJOR ${ORTHANC_FRAMEWORK_VERSION})\n      string(REGEX REPLACE ${RE} \"\\\\2\" ORTHANC_FRAMEWORK_MINOR ${ORTHANC_FRAMEWORK_VERSION})\n      string(REGEX REPLACE ${RE} \"\\\\3\" ORTHANC_FRAMEWORK_REVISION ${ORTHANC_FRAMEWORK_VERSION})\n\n      if (NOT ORTHANC_FRAMEWORK_MAJOR MATCHES \"^[0-9]+$\" OR\n          NOT ORTHANC_FRAMEWORK_MINOR MATCHES \"^[0-9]+$\" OR\n          NOT ORTHANC_FRAMEWORK_REVISION MATCHES \"^[0-9]+$\")\n        message(\"Bad version of the Orthanc framework: ${ORTHANC_FRAMEWORK_VERSION}\")\n      endif()\n\n      if (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.3.1\")\n        set(ORTHANC_FRAMEWORK_MD5 \"dac95bd6cf86fb19deaf4e612961f378\")\n      elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.3.2\")\n        set(ORTHANC_FRAMEWORK_MD5 \"d0ccdf68e855d8224331f13774992750\")\n      elseif (ORTHANC_FRAMEWORK_VERSION STREQUAL \"1.4.0\")\n        set(ORTHANC_FRAMEWORK_MD5 \"81e15f34d97ac32bbd7d26e85698835a\")\n      elseif\n      endif()\n    endif()\n  endif()\nendif()\n\n\n\n##\n## Detection of the third-party software\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"hg\")\n  find_program(ORTHANC_FRAMEWORK_HG hg)\n\n  if (${ORTHANC_FRAMEWORK_HG} MATCHES \"ORTHANC_FRAMEWORK_HG-NOTFOUND\")\n    message(FATAL_ERROR \"Please install Mercurial\")\n  endif()\nendif()\n\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"archive\" OR\n    ORTHANC_FRAMEWORK_SOURCE STREQUAL \"web\")\n  if (\"${CMAKE_HOST_SYSTEM_NAME}\" STREQUAL \"Windows\")\n    find_program(ORTHANC_FRAMEWORK_7ZIP 7z\n      PATHS\n      \"$ENV{ProgramFiles}/7-Zip\"\n      \"$ENV{ProgramW6432}/7-Zip\"\n      )\n\n    if (${ORTHANC_FRAMEWORK_7ZIP} MATCHES \"ORTHANC_FRAMEWORK_7ZIP-NOTFOUND\")\n      message(FATAL_ERROR \"Please install the '7-zip' software (http://www.7-zip.org/)\")\n    endif()\n\n  else()\n    find_program(ORTHANC_FRAMEWORK_TAR tar)\n    if (${ORTHANC_FRAMEWORK_TAR} MATCHES \"ORTHANC_FRAMEWORK_TAR-NOTFOUND\")\n      message(FATAL_ERROR \"Please install the 'tar' package\")\n    endif()\n  endif()\nendif()\n\n\n\n##\n## Case of the Orthanc framework specified as a path on the filesystem\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"path\")\n  if (NOT DEFINED ORTHANC_FRAMEWORK_ROOT)\n    message(FATAL_ERROR \"The variable ORTHANC_FRAMEWORK_ROOT must provide the path to the sources of Orthanc\")\n  endif()\n\n  if (NOT EXISTS ${ORTHANC_FRAMEWORK_ROOT})\n    message(FATAL_ERROR \"Non-existing directory: ${ORTHANC_FRAMEWORK_ROOT}\")\n  endif()\n\n  if (NOT EXISTS ${ORTHANC_FRAMEWORK_ROOT}/Resources/CMake/OrthancFrameworkParameters.cmake)\n    message(FATAL_ERROR \"Directory not containing the source code of Orthanc: ${ORTHANC_FRAMEWORK_ROOT}\")\n  endif()\n\n  set(ORTHANC_ROOT ${ORTHANC_FRAMEWORK_ROOT})\nendif()\n\n\n\n##\n## Case of the Orthanc framework cloned using Mercurial\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"hg\")\n  if (NOT STATIC_BUILD AND NOT ALLOW_DOWNLOADS)\n    message(FATAL_ERROR \"CMake is not allowed to download from Internet. Please set the ALLOW_DOWNLOADS option to ON\")\n  endif()\n\n  set(ORTHANC_ROOT ${CMAKE_BINARY_DIR}/orthanc)\n\n  if (EXISTS ${ORTHANC_ROOT})\n    message(\"Updating the Orthanc source repository using Mercurial\")\n    execute_process(\n      COMMAND ${ORTHANC_FRAMEWORK_HG} pull\n      WORKING_DIRECTORY ${ORTHANC_ROOT}\n      RESULT_VARIABLE Failure\n      )\n  else()\n    message(\"Forking the Orthanc source repository using Mercurial\")\n    execute_process(\n      COMMAND ${ORTHANC_FRAMEWORK_HG} clone \"https://bitbucket.org/sjodogne/orthanc\"\n      WORKING_DIRECTORY ${CMAKE_BINARY_DIR}\n      RESULT_VARIABLE Failure\n      )\n  endif()\n\n  if (Failure OR NOT EXISTS ${ORTHANC_ROOT})\n    message(FATAL_ERROR \"Cannot fork the Orthanc repository\")\n  endif()\n\n  message(\"Setting branch of the Orthanc repository to: ${ORTHANC_FRAMEWORK_BRANCH}\")\n\n  execute_process(\n    COMMAND ${ORTHANC_FRAMEWORK_HG} update -c ${ORTHANC_FRAMEWORK_BRANCH}\n    WORKING_DIRECTORY ${ORTHANC_ROOT}\n    RESULT_VARIABLE Failure\n    )\n\n  if (Failure)\n    message(FATAL_ERROR \"Error while running Mercurial\")\n  endif()\nendif()\n\n\n\n##\n## Case of the Orthanc framework provided as a source archive on the\n## filesystem\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"archive\")\n  if (NOT DEFINED ORTHANC_FRAMEWORK_ARCHIVE)\n    message(FATAL_ERROR \"The variable ORTHANC_FRAMEWORK_ARCHIVE must provide the path to the sources of Orthanc\")\n  endif()\nendif()\n\n\n\n##\n## Case of the Orthanc framework downloaded from the Web\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"web\")\n  if (DEFINED ORTHANC_FRAMEWORK_URL)\n    string(REGEX REPLACE \"^.*/\" \"\" ORTHANC_FRAMEMORK_FILENAME \"${ORTHANC_FRAMEWORK_URL}\")\n  else()\n    # Default case: Download from the official Web site\n    set(ORTHANC_FRAMEMORK_FILENAME Orthanc-${ORTHANC_FRAMEWORK_VERSION}.tar.gz)\n    #set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/get.php?path=/orthanc/${ORTHANC_FRAMEMORK_FILENAME}\")\n    set(ORTHANC_FRAMEWORK_URL \"http://www.orthanc-server.com/downloads/third-party/orthanc-framework/${ORTHANC_FRAMEMORK_FILENAME}\")\n  endif()\n\n  set(ORTHANC_FRAMEWORK_ARCHIVE \"${CMAKE_SOURCE_DIR}/ThirdPartyDownloads/${ORTHANC_FRAMEMORK_FILENAME}\")\n\n  if (NOT EXISTS \"${ORTHANC_FRAMEWORK_ARCHIVE}\")\n    if (NOT STATIC_BUILD AND NOT ALLOW_DOWNLOADS)\n      message(FATAL_ERROR \"CMake is not allowed to download from Internet. Please set the ALLOW_DOWNLOADS option to ON\")\n    endif()\n\n    message(\"Downloading: ${ORTHANC_FRAMEWORK_URL}\")\n\n    file(DOWNLOAD\n      \"${ORTHANC_FRAMEWORK_URL}\" \"${ORTHANC_FRAMEWORK_ARCHIVE}\"\n      SHOW_PROGRESS EXPECTED_MD5 \"${ORTHANC_FRAMEWORK_MD5}\"\n      TIMEOUT 60\n      INACTIVITY_TIMEOUT 60\n      )\n  else()\n    message(\"Using local copy of: ${ORTHANC_FRAMEWORK_URL}\")\n  endif()\nendif()\n\n\n\n\n##\n## Uncompressing the Orthanc framework, if it was retrieved from a\n## source archive on the filesystem, or from the official Web site\n##\n\nif (ORTHANC_FRAMEWORK_SOURCE STREQUAL \"archive\" OR\n    ORTHANC_FRAMEWORK_SOURCE STREQUAL \"web\")\n\n  if (NOT DEFINED ORTHANC_FRAMEWORK_ARCHIVE OR\n      NOT DEFINED ORTHANC_FRAMEWORK_VERSION OR\n      NOT DEFINED ORTHANC_FRAMEWORK_MD5)\n    message(FATAL_ERROR \"Internal error\")\n  endif()\n\n  if (ORTHANC_FRAMEWORK_MD5 STREQUAL \"\")\n    message(FATAL_ERROR \"Unknown release of Orthanc: ${ORTHANC_FRAMEWORK_VERSION}\")\n  endif()\n\n  file(MD5 ${ORTHANC_FRAMEWORK_ARCHIVE} ActualMD5)\n\n  if (NOT \"${ActualMD5}\" STREQUAL \"${ORTHANC_FRAMEWORK_MD5}\")\n    message(FATAL_ERROR \"The MD5 hash of the Orthanc archive is invalid: ${ORTHANC_FRAMEWORK_ARCHIVE}\")\n  endif()\n\n  set(ORTHANC_ROOT \"${CMAKE_BINARY_DIR}/Orthanc-${ORTHANC_FRAMEWORK_VERSION}\")\n\n  if (NOT IS_DIRECTORY \"${ORTHANC_ROOT}\")\n    if (NOT ORTHANC_FRAMEWORK_ARCHIVE MATCHES \".tar.gz$\")\n      message(FATAL_ERROR \"Archive should have the \\\".tar.gz\\\" extension: ${ORTHANC_FRAMEWORK_ARCHIVE}\")\n    endif()\n\n    message(\"Uncompressing: ${ORTHANC_FRAMEWORK_ARCHIVE}\")\n\n    if (\"${CMAKE_HOST_SYSTEM_NAME}\" STREQUAL \"Windows\")\n      # How to silently extract files using 7-zip\n      # http://superuser.com/questions/331148/7zip-command-line-extract-silently-quietly\n\n      execute_process(\n        COMMAND ${ORTHANC_FRAMEWORK_7ZIP} e -y ${ORTHANC_FRAMEWORK_ARCHIVE}\n        WORKING_DIRECTORY ${CMAKE_BINARY_DIR}\n        RESULT_VARIABLE Failure\n        OUTPUT_QUIET\n        )\n\n      if (Failure)\n        message(FATAL_ERROR \"Error while running the uncompression tool\")\n      endif()\n\n      get_filename_component(TMP_FILENAME \"${ORTHANC_FRAMEWORK_ARCHIVE}\" NAME)\n      string(REGEX REPLACE \".gz$\" \"\" TMP_FILENAME2 \"${TMP_FILENAME}\")\n\n      execute_process(\n        COMMAND ${ORTHANC_FRAMEWORK_7ZIP} x -y ${TMP_FILENAME2}\n        WORKING_DIRECTORY ${CMAKE_BINARY_DIR}\n        RESULT_VARIABLE Failure\n        OUTPUT_QUIET\n        )\n\n    else()\n      execute_process(\n        COMMAND sh -c \"${ORTHANC_FRAMEWORK_TAR} xfz ${ORTHANC_FRAMEWORK_ARCHIVE}\"\n        WORKING_DIRECTORY ${CMAKE_BINARY_DIR}\n        RESULT_VARIABLE Failure\n        )\n    endif()\n\n    if (Failure)\n      message(FATAL_ERROR \"Error while running the uncompression tool\")\n    endif()\n\n    if (NOT IS_DIRECTORY \"${ORTHANC_ROOT}\")\n      message(FATAL_ERROR \"The Orthanc framework was not uncompressed at the proper location. Check the CMake instructions.\")\n    endif()\n  endif()\nendif()\n"
        }
    ]
}